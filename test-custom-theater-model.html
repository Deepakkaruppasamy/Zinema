<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Custom Theater Model</title>
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background: #1a1a1a;
            color: white;
        }
        model-viewer {
            width: 100%;
            height: 500px;
            background-color: #2a2a2a;
            border-radius: 10px;
        }
        .status {
            margin: 20px 0;
            padding: 10px;
            border-radius: 5px;
        }
        .loading { background: #ffd700; color: #000; }
        .success { background: #4caf50; color: #fff; }
        .error { background: #f44336; color: #fff; }
        .info { background: #2196f3; color: #fff; }
        .warning { background: #ff9800; color: #fff; }
        .theater { background: #9c27b0; color: #fff; }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #444;
            border-radius: 8px;
        }
        .fallback-order {
            background: #2a2a2a;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>üé≠ Testing Your Custom Theater Model</h1>
    
    <div class="status theater">
        <strong>Your Custom Model:</strong> https://o9k2jza8ktnsxuxu.public.blob.vercel-storage.com/madame_walker_theatre.glb<br>
        <strong>Status:</strong> Now set as primary model with robust fallback system
    </div>
    
    <div class="test-section">
        <h3>Updated Fallback Order</h3>
        <div class="fallback-order">
            <strong>1. üé≠ Your Custom Theater Model</strong><br>
            <code>https://o9k2jza8ktnsxuxu.public.blob.vercel-storage.com/madame_walker_theatre.glb</code><br>
            <small>Primary choice with cache-busting and retry logic</small>
        </div>
        <div class="fallback-order">
            <strong>2. üåê External Fallback</strong><br>
            <code>https://modelviewer.dev/shared-assets/models/Astronaut.glb</code><br>
            <small>Reliable backup if your model has connection issues</small>
        </div>
        <div class="fallback-order">
            <strong>3. ‚úÖ Environment Model</strong><br>
            <code>VITE_3D_MODEL_URL</code><br>
            <small>User-configured fallback</small>
        </div>
        <div class="fallback-order">
            <strong>4. ‚ö†Ô∏è Local Model</strong><br>
            <code>/models/theature.glb</code><br>
            <small>Local backup (may have serving issues)</small>
        </div>
    </div>
    
    <div class="test-section">
        <h3>Test 1: Your Custom Theater Model (Primary)</h3>
        <div id="status1" class="status loading">üîÑ Loading your custom theater model...</div>
        <model-viewer 
            id="model-viewer1"
            src="https://o9k2jza8ktnsxuxu.public.blob.vercel-storage.com/madame_walker_theatre.glb"
            alt="Madame Walker Theatre 3D Model"
            auto-rotate
            camera-controls
            environment-image="neutral"
        ></model-viewer>
    </div>
    
    <div class="test-section">
        <h3>Test 2: Fallback System</h3>
        <div id="status2" class="status info">
            <strong>Fallback Behavior:</strong><br>
            ‚Ä¢ If your model loads: ‚úÖ Perfect! Your custom theater model is working<br>
            ‚Ä¢ If your model fails: üîÑ System will automatically try fallback models<br>
            ‚Ä¢ Connection issues: üîÑ Will retry with exponential backoff (1s, 2s, 4s)<br>
            ‚Ä¢ All models fail: üé≠ Will show geometric fallback model
        </div>
    </div>
    
    <div class="test-section">
        <h3>Test 3: Cache-Busting Test</h3>
        <div id="status3" class="status loading">üîÑ Testing with cache-busting parameter...</div>
        <model-viewer 
            id="model-viewer3"
            src="https://o9k2jza8ktnsxuxu.public.blob.vercel-storage.com/madame_walker_theatre.glb?v=1759562477866"
            alt="Madame Walker Theatre with Cache-Busting"
            auto-rotate
            camera-controls
            environment-image="neutral"
        ></model-viewer>
    </div>

    <script>
        // Test 1: Your custom theater model
        const modelViewer1 = document.getElementById('model-viewer1');
        const status1 = document.getElementById('status1');
        
        modelViewer1.addEventListener('load', () => {
            status1.className = 'status success';
            status1.innerHTML = '‚úÖ <strong>Success!</strong> Your custom theater model loaded perfectly!';
        });
        
        modelViewer1.addEventListener('error', (event) => {
            status1.className = 'status warning';
            status1.innerHTML = `‚ö†Ô∏è <strong>Connection Issue:</strong> Your model failed to load. ${event.detail?.message || 'This may be due to network restrictions or Vercel blob storage availability.'}`;
        });
        
        // Test 3: Cache-busting test
        const modelViewer3 = document.getElementById('model-viewer3');
        const status3 = document.getElementById('status3');
        
        modelViewer3.addEventListener('load', () => {
            status3.className = 'status success';
            status3.innerHTML = '‚úÖ <strong>Cache-Busting Success!</strong> Your model loaded with cache-busting parameter!';
        });
        
        modelViewer3.addEventListener('error', (event) => {
            status3.className = 'status warning';
            status3.innerHTML = `‚ö†Ô∏è <strong>Cache-Busting Issue:</strong> Even with cache-busting, the model failed. ${event.detail?.message || 'This indicates a persistent connection issue.'}`;
        });
        
        // Test URL accessibility for your custom model
        async function testCustomModelAccessibility() {
            try {
                const response = await fetch('https://o9k2jza8ktnsxuxu.public.blob.vercel-storage.com/madame_walker_theatre.glb', { 
                    method: 'HEAD',
                    mode: 'cors',
                    cache: 'no-cache'
                });
                
                console.log('Custom theater model accessibility test:', {
                    status: response.status,
                    ok: response.ok,
                    headers: {
                        'content-type': response.headers.get('content-type'),
                        'content-length': response.headers.get('content-length'),
                        'access-control-allow-origin': response.headers.get('access-control-allow-origin')
                    }
                });
                
                if (response.ok) {
                    console.log('‚úÖ Your custom theater model is accessible!');
                } else {
                    console.warn('‚ö†Ô∏è Your custom theater model may have accessibility issues:', response.status);
                }
            } catch (error) {
                console.error('‚ùå Custom theater model accessibility test failed:', error.message);
            }
        }
        
        // Test your custom model accessibility
        testCustomModelAccessibility();
    </script>
</body>
</html>
