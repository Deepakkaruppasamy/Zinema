<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test 3D Model from Vercel Blob Storage</title>
    <script type="module" src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background: #1a1a1a;
            color: white;
        }
        model-viewer {
            width: 100%;
            height: 500px;
            background-color: #2a2a2a;
            border-radius: 10px;
        }
        .status {
            margin: 20px 0;
            padding: 10px;
            border-radius: 5px;
        }
        .loading { background: #ffd700; color: #000; }
        .success { background: #4caf50; color: #fff; }
        .error { background: #f44336; color: #fff; }
        .info { background: #2196f3; color: #fff; }
    </style>
</head>
<body>
    <h1>🎭 Testing Madame Walker Theatre 3D Model</h1>
    
    <div class="status info">
        <strong>Testing URL:</strong> https://o9k2jza8ktnsxuxu.public.blob.vercel-storage.com/madame_walker_theatre.glb
    </div>
    
    <div id="status" class="status loading">
        🔄 Loading 3D model...
    </div>
    
    <model-viewer 
        id="model-viewer"
        src="https://o9k2jza8ktnsxuxu.public.blob.vercel-storage.com/madame_walker_theatre.glb"
        alt="Madame Walker Theatre 3D Model"
        auto-rotate
        camera-controls
        environment-image="neutral"
        poster="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='400' height='300'%3E%3Crect width='100%25' height='100%25' fill='%23333'/%3E%3Ctext x='50%25' y='50%25' font-size='20' text-anchor='middle' fill='white'%3ELoading 3D Model...%3C/text%3E%3C/svg%3E"
        loading="lazy"
        reveal="interaction"
    >
        <div class="progress-bar" id="progress-bar" slot="progress-bar">
            <div class="update-bar"></div>
        </div>
    </model-viewer>
    
    <div class="status info">
        <h3>🔧 Troubleshooting Guide:</h3>
        <ul>
            <li><strong>If model loads:</strong> ✅ Your Vercel blob storage is working correctly!</li>
            <li><strong>If it fails:</strong> ❌ Check network connectivity and Vercel blob permissions</li>
            <li><strong>Cache issues:</strong> 🔄 Try refreshing the page or opening in incognito mode</li>
            <li><strong>CORS errors:</strong> 🛡️ Vercel blob storage should handle CORS automatically</li>
        </ul>
    </div>

    <script>
        const modelViewer = document.getElementById('model-viewer');
        const statusDiv = document.getElementById('status');
        
        // Track loading progress
        modelViewer.addEventListener('progress', (event) => {
            const progress = event.detail.totalProgress;
            statusDiv.className = 'status loading';
            statusDiv.innerHTML = `🔄 Loading 3D model... ${Math.round(progress * 100)}%`;
        });
        
        // Model loaded successfully
        modelViewer.addEventListener('load', () => {
            statusDiv.className = 'status success';
            statusDiv.innerHTML = '✅ <strong>Success!</strong> Your Vercel blob storage 3D model loaded correctly!';
            console.log('✅ 3D Model loaded successfully from Vercel blob storage');
        });
        
        // Model failed to load
        modelViewer.addEventListener('error', (event) => {
            statusDiv.className = 'status error';
            statusDiv.innerHTML = `❌ <strong>Error:</strong> Failed to load 3D model. ${event.detail?.message || 'Connection or CORS issue.'}`;
            console.error('❌ 3D Model failed to load:', event.detail);
        });
        
        // Test direct fetch to check accessibility
        fetch('https://o9k2jza8ktnsxuxu.public.blob.vercel-storage.com/madame_walker_theatre.glb', {
            method: 'HEAD'
        })
        .then(response => {
            console.log('🔍 Direct fetch test:', {
                status: response.status,
                ok: response.ok,
                headers: {
                    'content-type': response.headers.get('content-type'),
                    'content-length': response.headers.get('content-length'),
                    'access-control-allow-origin': response.headers.get('access-control-allow-origin')
                }
            });
        })
        .catch(error => {
            console.error('🔍 Direct fetch failed:', error);
        });
    </script>
</body>
</html>
